(function() {
    var ChessBoard = function(id, config) {
        console.log("Initializing Chessboard with id:", id); // Debugging
        var boardElement = document.getElementById(id);
        if (!boardElement) {
            console.error("Element with id", id, "not found!"); // Debugging
            return null;
        }
        console.log("Board element found:", boardElement); // Debugging

        boardElement.innerHTML = '';
        var squares = [];
        for (var i = 0; i < 8; i++) {
            for (var j = 0; j < 8; j++) {
                var square = document.createElement('div');
                square.className = 'square-55d63';
                if ((i + j) % 2 === 0) {
                    square.classList.add('white');
                } else {
                    square.classList.add('black');
                }
                boardElement.appendChild(square);
                squares.push(square);
            }
        }

        console.log("Chessboard squares created:", squares); // Debugging

        // Function to set the position of the pieces
        function setPosition(position) {
            console.log("Setting position:", position); // Debugging
            // Clear the board
            squares.forEach(function(square) {
                square.innerHTML = '';
            });

            // Place the pieces on the board
            for (var pos in position) {
                if (position.hasOwnProperty(pos)) {
                    var piece = position[pos];
                    var squareIndex = (8 - pos[1]) * 8 + (pos[0].charCodeAt(0) - 'a'.charCodeAt(0));
                    var img = document.createElement('img');
                    img.src = '{% static \'pieces/' + piece + '.svg\' %}'; // Path to the SVG file
                    img.classList.add('piece-417db');
                    squares[squareIndex].appendChild(img);
                }
            }
        }

        return {
            position: function(pos) {
                setPosition(pos);
            },
            clear: function() {
                squares.forEach(function(square) {
                    square.innerHTML = '';
                });
            }
        };
    };
    window.Chessboard = ChessBoard;
})();